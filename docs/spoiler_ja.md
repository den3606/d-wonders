# Spoilers(v1.0.1)

d-wonders のスペル仕様に関して、特筆するべきスペルのネタバレを書いてます。
全てを細かく書いているわけではないので、ご了承ください。
ネタバレが嫌な方は見ないようにしてください。

## スタックボルト

一発発射するごとに、プレイヤーに対してスタックボルト発射によって貯まるカウンター（以降スタック値と呼称）を 1 溜めていきます。
スタックボルトの値は 100F 後にリセットされます。
スタック値はプレイヤーに保存しているので、敵がスタック値を貯めることはありません。

スタックボルトには 3 段階のレベルがあり、スタック値一定以上貯まるとスタックボルトが強くなります。

1. 240 以下
   - 色が緑色で発射されます
   - ダメージ計算式
     - 0.04 + (0.04 \* math.max(math.floor(stack_count / 60), 1))
2. 480 以下
   - 色が黄色で発射されます
   - ダメージ計算式
     - 0.04 + (0.04 \* math.max(math.floor(stack_count / 60), 1))
3. 480 より上
   - 色が赤色で発射されます
   - 射程が大幅に伸びます
   - ダメージ計算式
     - 0.08 + (0.04 \* math.floor(math.log(math.floor(stack_count - 550), 2) + 3.4))

他の性能に関しては、スパークボルトと類似しています。

### 同時詠唱について

スタックボルトとと同時詠唱された放射物も、スタックを増加させます。
例えば、以下の並びで発射するとスタック値は 3 増えます。

[3 倍詠唱][スタックボルト][スパークボルト][スパークボルト]

## チャージボルト

4 回チャージして、5 回目に発射します。
内部処理的には、4 回までのチャージ用放射物とチャージ後の放射物で分かれています。
チャージ用放射物は 1F 後に放射物自体を強制的に削除する処理が入っています。

チャージ後の放射物には根本のダメージとエリアダメージ判定があります。
根本は 75dmg で、周りには 32x32 の円で 15dmg/1F の判定があります。

## 古代のハンマー

詠唱遅延と拡散がランダムで決まります
衝突による消滅がないので、近接ダメージが 10dmg/1F あります。

## 死神の鎌

基本的には射出距離が長くなった古代のハンマーです。
相違点としては、

- 属性がスライスダメージに変更されている
- Player に対してのブーメラン効果が薄く乗っている

です。近づくとホーミングされるので気をつけてね。

## 風船系

重力が非常に軽く設定してあるので、ホーミングをつけるとかなり早く飛んでいきます。
また、素材系と同じ Wet 効果が付与されているので、属性クリティカルと同時に詠唱すると、確定でクリティカルが発生するようになります。

### 紅血の風船

この風船は特殊で、50%の確率で風船の中からモンスターがでてきます。
モンスターの種類はさらにランダム化されています。

- 70%でフレンドリーなモンスターと弱い敵が出現する
- 10%でフレンドリーなモンスターとヒーシ系の敵が出現する
- 10%でフレンドリーなモンスターとヒーシ系の敵と強いヒーシ系の敵が出現する
- 5%で爆発する鹿が出現する
- 5%で回復ヒーシが出現する

上記の抽選が行われる前段階での抽選で 1/1000000 を引くと、風船の中からドラゴンがでてきます。こわいね。

## 猛毒のフラスコ

フラスコ本体が酸でできているので、酸で溶かせる物質を少し溶かせます。

## ヘモキネシス

使用ごとに HP を 1 減らして、HP が 0 になると出血多量で死にます。

## シャークランチャー

サメにフレッシュゴア（BLOOD_EXPLOSION）がついているので、攻撃させると大量の液体が出ます。
サメ自体からは少量の水が放出されます。

## 契約書

相手の HP に応じて契約時にお金が最大 100 ゴールド支払われます。
ゴールドを所持していなかった場合は支払うゴールドの 1/2 の量を HP で支払います。
HP で支払えなかった場合は死にます。
支払い時に Player のユニットが見つからなかった場合は、無料で契約できます。

## リキッドショット

無印のリキッドショットから別のリキッドショットへの変換ができます。

### リキッドショット[揺]

他のリキッドショットからリキッドショット[揺]に変換することができ、無印と同様にリキッドショットへの変換ができます。

### リキッドショット[転]

射出時および射出から 20F ごとに半径 85 の敵を探して、見つかった場合はその敵に瞬間移動します。

### 対応表

- 酸
  - 酸
- バーサキアム
  - 怒
- 血系（ワームを除く）
  - 血
- フェロモン、栄養たっぷりなポリッジ
  - 愛
- 不吉な液体、虚無の液体
  - 闇
- ワームフェロモン、ワーム血
  - 蟲
- 溶岩
  - 獄
- 魔法の液体、マナ液体、ミダス、インビジビリウム
  - 魔
- オイル
  - 油
- 毒、貪欲の呪いの液体（大木の貪欲パークを取ったときに出る液体）
  - 猛
- スライム系、ピート
  - 柔
- 移動速度系
  - 速
- 不安定テレポート、テレポート
  - 転
- 猛毒ヘドロ系
  - 毒
- 水系
  - 水
- 不安定多形、多形、カオス多形
  - 乱
- フルモキシウム、虹、アルコール系
  - 揺

上記のリキッドショットはすべて「揺」に変換可能です。また、「揺」からすべてのリキッドショットへの変換が可能です。

## 依存性のボルト

すべての呪文に対して属性をつけるタイプの調整盤（ダメージプラス等）と同時に詠唱すると、同時詠唱した追加ダメージのタイプに基づく放射物が発射されます。
またダメージ系がない場合、スペル名から属性にあった名前が無いかを探して、見つかった場合はその属性の放射物を詠唱します。

### 対応表

- 物理ダメージ
  - 0 より上
    - 触手
- 放射物ダメージ
  - 0 より上で 10 未満
    - 集中ライト
  - 10 以上
    - チェーンボルト x2
  - 上記にマッチしないかつ、"projectile"を名称に含む調整盤がある
    - チェーンボルト x2
- 電撃ダメージ
  - 0 より上で 5 未満
    - 稲妻ボルト
  - 5 以上
    - 稲妻ボルト x2
  - 上記にマッチしないかつ、"electric"を名称に含む調整盤がある
    - 稲妻ボルト
- 炎ダメージ
  - 0 より上で 5 未満
    - ファイアボルト x2
  - 5 以上
    - 隕石
  - 上記にマッチしないかつ、"fire"を名称に含む調整盤がある
    - 隕石
- 爆破ダメージ
  - 0 より上で 5 未満
    - TNT
  - 5 以上 10 未満
    - 爆弾
  - 10 以上 10 より上で 5 未満
    - 神聖な爆弾
  - 15 以上
    - ギガ神聖な爆弾
  - 上記にマッチしないかつ、"explosion", "explode"を名称に含む調整盤がある
    - 神聖な爆弾
- 凍結ダメージ
  - 0 より上で 5 以下
    - 氷の球
  - 5 より上で 10 以下
    - 凍結凝視（12 本で拡散が本家より-10 度）
  - 10 より上で 15 以下
    - 凍結フィールド
  - 15 より上
    - 凍結エリアフィールド
  - 上記にマッチしないかつ、"freeze", "frozen", "ice"を名称に含む調整盤がある
    - 氷の球
- スライスダメージ
  - 0 より上で 5 未満
    - 円盤放射物
  - 5 以上 10 未満
    - ギガディスク
  - 10 以上 10 より上で 5 未満
    - オメガディスク
  - 上記にマッチしないかつ、"slice", "disc"を名称に含む調整盤がある
    - 円盤放射物
- 回復ダメージ
  - -5 より上で 0 より下
    - 治癒ボルト
  - -5 以下
    - 回復のフィールド
- 呪いダメージ
  - 0 より上で 5 未満
    - 呪われたオーブ x2
  - 5 以上
    - リキッドショット[闇]x2
  - 上記にマッチしないかつ、"poison", "curse", "toxic"を名称に含む調整盤がある
    - リキッドショット[闇]
- ドリルダメージ
  - 0 より上で 5 未満
    - 光る槍
  - 5 以上
    - プラズマカッター

## ソウルショット

相手にソウルを貯めるための処理（ソウル状態にする処理）を付与する処理が放射物に設定されています。
ソウル状態にする処理は、放射物よりも 2 倍の円に触れた敵に対して付与されます。
ソウル状態になった敵を倒すと、倒した敵の最大 HP をソウル値としてプレイヤーに保存します。

再度ソウルショットを発射する際、発射されるソウルショットが Player に保存されているソウル値を参照します。ソウル値の値によって、発射されるソウルショットの呪いダメージに倍率補正がかかります。ソウルショットを発射すると、プレイヤーに保存されているソウル値が-1されます。

Player に保存されているソウルと倍率の関係は以下です。

- 20 まで
  - 等倍（5dmg）
- 100 まで
  - 1.5 倍（7.5dmg）
- 500 まで
  - 2 倍（10dmg）
- 2000 まで
  - 3 倍（15dmg）
- 10000 まで
  - 4 倍（20dmg）
- 10000 以上
  - 5 倍（25dmg）

ソウルショットが0以上の場合は、白色のゴーストがソウルショット発射時に出現します。
3倍以上の倍率がかかっていた場合は赤色のゴーストがソウルショット発射時に出現します。

## 流れ星

黄色には放射物ダメージ
赤色には炎ダメージ
青色には氷ダメージ
緑色には電気ダメージ

がエリアダメージとして設定されています。


## バッテリーライト

バッテリーライトと同じインベントリー内（杖なら杖内）に"spark_electric"を名称に持つスペルがある場合、充電可能とみなして回数制限を無制限にします。
（基本的に電気系のスペルなら無限になる）

## 凍結ダメージ反転

自身よりも前に追加されている氷ダメージをマイナスの回復ダメージに変換します。
可能な限り、凍結についている凍結エフェクト等を外します。

## スペルバキューム

動作としては、トリガー追加等と同じ動きをします。
スペルバキュームよりも１つ後ろにあるスペルの「ダメージ」「放射物速度」「放射物寿命」「爆破範囲」「エリアダメージ」
を取得して、取得した数値を調整版として同時詠唱内のスペルに付与します。
